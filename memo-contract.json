{
  "seatable": {
    "table_name": "确认收入",
    "name_column": "合同编号"
  },
  "chunk_size": 300,
  "data_mappings": [
    {
      "description": "主表数据",
      "sql_query": [
        "SELECT",
        "  ptc.contract_code,",
        "  ptc.total_project_name,",
        "  ptc.contract_year,",
        "  IFNULL(ptc.contract_amount, '') AS contract_amount,",
        "  IFNULL(ptc.project_manager_name_new, '') AS project_manager_name,",
        "  IFNULL(ptc.site_leader, '') AS site_leader,",
        "  IFNULL(ptc.acceptance_report_signatories, '') AS acceptance_report_signatories,",
        "  IFNULL(ptc.receipt_goods_signatories, '') AS receipt_goods_signatories,",
        "  IFNULL(ptc.process_documentation_relationship_person, '') AS process_documentation_relationship_person,",
        "  IFNULL(ptc.contract_sign_date, '') AS contract_sign_date,",
        "  IFNULL(ptc.sales_manager_name, '') AS sales_manager_name,",
        "  IFNULL(ptc.customer_units, '') AS customer_units,",
        "  IFNULL(ptc.sale_province, '') AS sale_province,",
        "  IFNULL(ptc.downstream_areas, '') AS downstream_areas,",
        "  IFNULL(ptc.payment_method, '') AS payment_method,",
        "  COALESCE(sdd_channel.dict_label, ptc.channel) AS channel,",
        "  COALESCE(sdd_project_type.dict_label, ptc.project_type) AS project_type,",
        "  COALESCE(sdd_contract_type.dict_label, ptc.contract_type) AS contract_type,",
        "  COALESCE(sdd_firm_name.dict_label, ptc.firm_name) AS firm_name,",
        "  COALESCE(sdd_general_whether.dict_label, ptc.if_jdys) AS if_jdys,",
        "  COALESCE(sdd_whether_limit_zb_fb.dict_label, ptc.whether_limit_zb_fb) AS whether_limit_zb_fb,",
        "  COALESCE(project_delivery_status.dict_label, ptc.project_delivery_status) AS project_delivery_status,",
        "  COALESCE(sdd_acceptance_required.dict_label, ptc.acceptance_required) AS acceptance_required,",
        "  COALESCE(sdd_winning_bid_book.dict_label, ptc.winning_bid_book) AS winning_bid_book,",
        "  COALESCE(sdd_customer_type.dict_label, ptc.customer_type) AS customer_type,",
        "  COALESCE(sdd_sales_territory.dict_label, ptc.sales_territory) AS sales_territory,",
        "  COALESCE(sdd_customer_obtained_way.dict_label, ptc.customer_obtained_way) AS customer_obtained_way,",
        "  COALESCE(sdd_if_classified.dict_label, ptc.if_classified) AS if_classified,",
        "  COALESCE(sdd_if_retention_money.dict_label, ptc.if_retention_money) AS if_retention_money,",
        "  COALESCE(sdd_budget.dict_label, ptc.budget_status) AS budget_status,",
        "  IFNULL(ptc.field_acceptance_owner, '') AS field_acceptance_owner,",
        "  IFNULL(ptc.tqjch_date, '') AS tqjch_date,",
        "  IFNULL(ptc.contract_begin_time, '') AS contract_begin_time,",
        "  IFNULL(ptc.completion_time, '') AS completion_time,",
        "  IFNULL(ptc.contract_finish_date, '') AS contract_finish_date,",
        "  IFNULL(ptc.yqh_date, '') AS yqh_date,",
        "  IFNULL(ptc.yqh_duration, '') AS yqh_duration,",
        "  IFNULL(ptc.yq_explain, '') AS yq_explain,",
        "  IFNULL(ptc.yys_date, '') AS yys_date,",
        "  IFNULL(ptc.acceptance_document_submit_date, '') AS acceptance_document_submit_date,",
        "  IFNULL(ptc.overdue_point_date, '') AS overdue_point_date,",
        "  IFNULL(ptc.dept_id, '') AS dept_id,",
        "  IFNULL(ptc.yxfz_dept, '') AS yxfz_dept,",
        "  IFNULL(ptc.jf_dept, '') AS jf_dept,",
        "  IFNULL(ptc.out_jf_dept, '') AS out_jf_dept,",
        "  IFNULL(ptc.yys_amount, '') AS yys_amount,",
        "  IFNULL(ptc.already_overdue_days, '') AS already_overdue_days,",
        "  IFNULL(ptc.already_overdue_month, '') AS already_overdue_month,",
        "  IFNULL(ptc.qrsr_date, '') AS qrsr_date,",
        "  IFNULL(ptc.review_acceptance_date, '') AS review_acceptance_date,",
        "  IFNULL(ptc.dd_contract_end_date, '') AS dd_contract_end_date,",
        "  IFNULL(ptc.contrat_end_time, '') AS contrat_end_time,",
        "  IFNULL(ptc.winning_bid_book_date, '') AS winning_bid_book_date,",
        "  IFNULL(ptc.arrival_receipt_receipt_date, '') AS arrival_receipt_receipt_date,",
        "  IFNULL(ptc.end_customer_name, '') AS end_customer_name,",
        "  IFNULL(ptc.contract_duration, '') AS contract_duration,",
        "  IFNULL(ptc.initial_inspection_report_date, '') AS initial_inspection_report_date,",
        "  IFNULL(ptc.during_test_run, '') AS during_test_run,",
        "  IFNULL(ptc.devops_ht_start_time, '') AS devops_ht_start_time,",
        "  IFNULL(ptc.devops_ht_end_time, '') AS devops_ht_end_time,",
        "  IFNULL(ptc.payment_method, '') AS payment_method,",
        "  IFNULL(ptc.retention_money_term, '') AS retention_money_term,",
        "  IFNULL(ptc.zbq_period, '') AS zbq_period,",
        "  IFNULL(ptc.contract_zqbtime, '') AS contract_zqbtime,",
        "  IFNULL(ptc.contract_start_time, '') AS contract_start_time,",
        "  IFNULL(ptc.rial_run_start_time, '') AS rial_run_start_time,",
        "  IFNULL(ptc.rial_run_end_time, '') AS rial_run_end_time,",
        "  IFNULL(ptc.xslx_sp_start_time, '') AS xslx_sp_start_time,",
        "  IFNULL(ptc.xslx_sp_end_time, '') AS xslx_sp_end_time,",
        "  IFNULL(ptc.ht_sp_start_time, '') AS ht_sp_start_time,",
        "  IFNULL(ptc.ht_sp_end_time, '') AS ht_sp_end_time,",
        "  IFNULL(ptc.htyj_start_time, '') AS htyj_start_time,",
        "  IFNULL(ptc.htyj_end_time, '') AS htyj_end_time,",
        "  IFNULL(ptc.xmys_sp_start_time, '') AS xmys_sp_start_time,",
        "  IFNULL(ptc.xmys_sp_end_time, '') AS xmys_sp_end_time,",
        "  IFNULL(ptc.jfdept_zb_start_time, '') AS jfdept_zb_start_time,",
        "  IFNULL(ptc.jfdept_zb_end_time, '') AS jfdept_zb_end_time,",
        "  IFNULL(ptc.jfdept_gs_start_time, '') AS jfdept_gs_start_time,",
        "  IFNULL(ptc.jfdept_gs_end_time, '') AS jfdept_gs_end_time,",
        "  IFNULL(ptc.reference_date, '') AS reference_date,",
        "  IFNULL(ptc.yjys_date, '') AS yjys_date,",
        "  IFNULL(ptc.warranty_amount, '') AS warranty_amount",
        "FROM project_total_contract ptc",
        "LEFT JOIN sys_dict_data sdd_firm_name ON ptc.firm_name = sdd_firm_name.dict_value AND sdd_firm_name.dict_type = 'firm_name'",
        "LEFT JOIN sys_dict_data sdd_general_whether ON ptc.if_jdys = sdd_general_whether.dict_value AND sdd_general_whether.dict_type = 'general_whether'",
        "LEFT JOIN sys_dict_data sdd_whether_limit_zb_fb ON ptc.whether_limit_zb_fb = sdd_whether_limit_zb_fb.dict_value AND sdd_whether_limit_zb_fb.dict_type = 'contract_wbys'",
        "LEFT JOIN sys_dict_data project_delivery_status ON ptc.project_delivery_status = project_delivery_status.dict_value AND project_delivery_status.dict_type = 'project_delivery_status'",
        "LEFT JOIN sys_dict_data sdd_channel ON ptc.channel = sdd_channel.dict_value AND sdd_channel.dict_type = 'channel'",
        "LEFT JOIN sys_dict_data sdd_project_type ON ptc.project_type = sdd_project_type.dict_value AND sdd_project_type.dict_type = 'project_kind'",
        "LEFT JOIN sys_dict_data sdd_contract_type ON ptc.contract_type = sdd_contract_type.dict_value AND sdd_contract_type.dict_type = 'contract_type'",
        "LEFT JOIN sys_dict_data sdd_budget ON ptc.budget_status = sdd_budget.dict_value AND sdd_budget.dict_type = 'budget'",
        "LEFT JOIN sys_dict_data sdd_winning_bid_book ON ptc.winning_bid_book = sdd_winning_bid_book.dict_value AND sdd_winning_bid_book.dict_type = 'contract_winn_bid_book'",
        "LEFT JOIN sys_dict_data sdd_customer_type ON ptc.customer_type = sdd_customer_type.dict_value AND sdd_customer_type.dict_type = 'customer_type'",
        "LEFT JOIN sys_dict_data sdd_sales_territory ON ptc.sales_territory = sdd_sales_territory.dict_value AND sdd_sales_territory.dict_type = 'sales_territory'",
        "LEFT JOIN sys_dict_data sdd_customer_obtained_way ON ptc.customer_obtained_way = sdd_customer_obtained_way.dict_value AND sdd_customer_obtained_way.dict_type = 'cust_contract_get_way'",
        "LEFT JOIN sys_dict_data sdd_if_classified ON ptc.if_classified = sdd_if_classified.dict_value AND sdd_if_classified.dict_type = 'general_whether'",
        "LEFT JOIN sys_dict_data sdd_if_retention_money ON ptc.if_retention_money = sdd_if_retention_money.dict_value AND sdd_if_retention_money.dict_type = 'general_whether'",
        "LEFT JOIN sys_dict_data sdd_acceptance_required ON ptc.acceptance_required = sdd_acceptance_required.dict_value AND sdd_acceptance_required.dict_type = 'acceptance_required'",
        "WHERE ptc.contract_year IN (2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025)",
        "AND ptc.firm_name != '40';"
      ],
      "field_mappings": {
        "contract_code": "合同编号",
        "total_project_name": "项目名称",
        "contract_amount": "合同金额",
        "yys_amount": "阶段已验收额",
        "if_jdys": "是否阶段验收",
        "yys_date": "阶段验收时间",
        "contract_sign_date": "合同签订日期",
        "contract_year": "年份",
        "winning_bid_book": "中标通知书",
        "winning_bid_book_date": "中标日期",
        "arrival_receipt_receipt_date": "到货签收单日期",
        "sales_manager_name": "销售负责人姓名",
        "customer_units": "用户单位",
        "channel": "渠道",
        "firm_name": "所属公司",
        "field_acceptance_owner": "验收负责人",
        "jf_dept": "实际交付部门",
        "out_jf_dept": "对外交付部门",
        "dept_id": "营销部门",
        "yxfz_dept": "营销辅助部门",
        "contrat_end_time": "验收日",
        "review_acceptance_date": "报审验收日期",
        "dd_contract_end_date": "笃定验收日期",
        "acceptance_required": "是否需要验收",
        "acceptance_document_submit_date": "验收报告提交日期",
        "overdue_point_date": "验收逾期时点",
        "already_overdue_days": "已逾期天数",
        "already_overdue_month": "已逾期月数",
        "contract_finish_date": "合同到期日",
        "yqh_date": "延期后日期",
        "yqh_duration": "延期后工期",
        "yq_explain": "延期说明",
        "project_manager_name": "项目经理姓名",
        "site_leader": "现场负责人",
        "acceptance_report_signatories": "验收报告签字人",
        "receipt_goods_signatories": "货品签收单签字人",
        "process_documentation_relationship_person": "过程文档涉及人",
        "project_delivery_status": "项目交付状态",
        "project_type": "项目类型",
        "contract_type": "合同类型",
        "qrsr_date": "确收日",
        "tqjch_date": "提前进场函日期",
        "contract_begin_time": "开工通知书日期",
        "completion_time": "完工时间",
        "end_customer_name": "终端客户",
        "customer_type": "客户类型",
        "sales_territory": "销售地区",
        "sale_province": "销售省份",
        "customer_obtained_way": "业务取得方式",
        "if_classified": "是否涉密",
        "contract_duration": "约定实施周期",
        "initial_inspection_report_date": "初验日期",
        "during_test_run": "试运行期间",
        "devops_ht_start_time": "运维合同起始日期",
        "devops_ht_end_time": "运维合同终止日期",
        "payment_method": "结算方式",
        "if_retention_money": "是否有质保金",
        "retention_money_term": "质保金条款",
        "zbq_period": "质保金周期",
        "contract_zqbtime": "质保金终止日期",
        "warranty_amount": "质保金金额",
        "budget_status": "有无预算",
        "payment_method": "付款方式",
        "rial_run_start_time": "试运行开始时间",
        "rial_run_end_time": "试运行结束时间",
        "xslx_sp_start_time": "销售立项开始时间",
        "xslx_sp_end_time": "销售立项结束时间",
        "ht_sp_start_time": "合同审批开始时间",
        "ht_sp_end_time": "合同审批结束时间",
        "htyj_start_time": "合同移交开始时间",
        "htyj_end_time": "合同移交结束时间",
        "xmys_sp_start_time": "项目预算开始时间",
        "xmys_sp_end_time": "项目预算结束时间",
        "jfdept_zb_start_time": "周报开始时间",
        "jfdept_zb_end_time": "周报结束时间",
        "jfdept_gs_start_time": "工时开始时间",
        "jfdept_gs_end_time": "工时结束时间",
        "whether_limit_zb_fb": "外包约束",
        "reference_date": "参考时间",
        "yjys_date": "预计验收时间",
        "downstream_areas": "下游区域"
      }
    },
    {
      "description": "pro_tag表数据",
      "sql_query": [
        "SELECT",
        "pro_code,",
        "GROUP_CONCAT(tag_content SEPARATOR ', ') AS tags",
        "FROM pro_tag",
        "GROUP BY pro_code;"
      ],
      "field_mappings": {
        "pro_code": "合同编号",
        "tags": "标签"
      },
      "merge_rules": {
        "merge_into": "主表数据",
        "on": "合同编号",
        "target_field": "标签"
      }
    }
  ]
}
